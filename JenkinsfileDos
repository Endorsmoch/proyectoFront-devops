pipeline {
    agent any

    parameters {
        string(name: 'BUILD_NUMBER', defaultValue: '', description: 'Número de versión')
        string(name: 'DIST_PATH', defaultValue: '', description: 'Ruta del directorio dist')
    }

    stages {
        stage('Conexión SSH y transferencia de archivos') {
            steps {
                script {
                    // Dirección IP de la máquina virtual
                    def vmIP = '192.168.0.26'
                    // Nombre de usuario para la conexión SSH
                    def sshUser = 'ubuntu'
                    // Contraseña para la conexión SSH
                    def sshPassword = 'ubuntu'

                    // Comando para ejecutar en la máquina virtual
                    def xcopyCommand = "xcopy ${env.DIST_PATH} \\\\${vmIP}\\devops_web\\ /E /Y"

                    // Ejecutar el comando Xcopy
                    bat(xcopyCommand)
                }
            }
        }
    }

    post {
        success {
            echo '¡El segundo pipeline se ha completado exitosamente!'
        }
        failure {
            echo 'El segundo pipeline ha fallado!'
        }
    }
}
