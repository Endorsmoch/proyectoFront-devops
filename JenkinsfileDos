pipeline {
  agent any

  parameters {
    string(name: 'BUILD_NUMBER', defaultValue: '', description: 'Número de versión')
    string(name: 'DIST_PATH', defaultValue: '', description: 'Ubicación del build')

  }
    

  stages {
    stage('Conexión SSH y comandos en la máquina virtual') {
      steps {
        script {
          // Dirección IP de la máquina virtual
          def vmIP = '192.168.0.26'
          // Nombre de usuario para la conexión SSH
          def sshUser = 'ubuntu'
          // Contraseña para la conexión SSH
          def sshPassword = 'ubuntu'

          def folder = '../../var/www/html/devops_web'

          def pscpPath = 'C:/Users/gener/OneDrive/Escritorio/pscp.exe'

          // Huella digital del servidor SSH
          def hostKey = 'ssh-ed25519 255 SHA256:V4rGl41cT7XvnrAFEE+wPLvrONJp6uCabSN1oBFVtdc'

          def sshCommandFull = "${pscpPath} -pw ${sshPassword} -P 22 ${params.DIST_Path}\\* ${sshUser}@${vmIP}:${folder}"
          bat(sshCommandFull)
        }
      }
    }
  }
  post {
        success {
            echo '¡El segundo pipeline se ha completado exitosamente!'
        }
        failure {
            echo 'El segundo pipeline ha fallado!'
        }
    }
}